<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scrollytelling Timeline</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body { margin:0; font-family:"Noto Sans Bengali", system-ui, sans-serif; background:#fff; }

    .timeline-sticky {
      position: sticky; top: 0; z-index: 50;
      background: #fff;
      border-bottom: 1px solid #eee;
      padding: 14px 16px 10px;
    }
    .topline { display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap; }
    .title { font-weight: 800; }

    .timeline-wrap { position: relative; height: 72px; margin-top: 10px; }
    .track { position:absolute; left:0; right:0; top:28px; height: 6px; border-radius: 999px; background:#eee; }
    .progress { position:absolute; left:0; top:28px; height: 6px; border-radius: 999px; background:#111; width: 0%; transition: width 240ms ease; }
    .playhead { position:absolute; top:18px; left:0%; width: 18px; height: 18px; border-radius: 50%; background:#111; transform: translateX(-50%); transition: left 240ms ease; }

    .ticks { position:absolute; left:0; right:0; top: 20px; height: 24px; pointer-events:none; }
    .tick { position:absolute; top: 0; width: 10px; height: 24px; transform: translateX(-50%); display:flex; align-items:flex-end; justify-content:center; }
    .tick::before{ content:""; width: 2px; height: 14px; border-radius: 2px; background:#bbb; }
    .tick.is-active::before{ background:#111; height: 18px; }

    .activeTimeCenter {
      position:absolute; left:50%; top: 46px; transform: translateX(-50%);
      font-size: 13px; color:#444; font-weight: 600; white-space: nowrap;
    }

    .labels { margin-top: 8px; display:flex; justify-content:space-between; font-size: 12px; color:#666; }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px 16px 60px;
      display: grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: 18px;
    }

    .step {
      background:#fff;
      border: 1px solid #eee;
      border-radius: 16px;
      padding: 18px;
      margin-bottom: 18px;
      min-height: 65vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .step.is-active { border-color:#111; box-shadow: 0 10px 24px rgba(0,0,0,.06); }
    .step .when { color:#666; font-size: 12px; margin-bottom: 10px; }
    .step h3 { margin:0 0 10px 0; font-size: 20px; }
    .step p { margin:0; line-height: 1.75; color:#222; }

    .scene {
      position: sticky;
      top: 108px;
      border: 1px solid #eee;
      border-radius: 16px;
      overflow: hidden;
      background:#fafafa;
      height: calc(100dvh - 126px);
    }
    @supports not (height: 100dvh) {
      .scene { height: calc(100vh - 126px); }
    }

    .scene img { width:100%; height: 62%; object-fit: cover; display:block; background:#ddd; }
    .scene .content { height:38%; overflow:auto; background:#fff; padding: 14px; }

    /* Desktop: keep right-side minimal (only shortText). */
    .scene h2, .scene .meta { display:none; }
    .scene .body { color:#222; line-height: 1.65; font-size: 14px; }

    /* Mobile-only details block */
    .mobileDetails {
      display:none;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #eee;
    }
    .mobileDetails .mWhen { font-size: 12px; color:#666; margin-bottom: 6px; }
    .mobileDetails .mTitle { font-size: 16px; font-weight: 800; margin: 0 0 8px 0; }
    .mobileDetails .mLong { font-size: 14px; line-height: 1.75; color:#222; }

    /* ✅ MOBILE: scene stays sticky + show mobileDetails */
    @media (max-width: 900px){
      .container { grid-template-columns: 1fr; }

      .scene{
        position: sticky;
        top: 92px;
        height: 62dvh;
        margin-bottom: 14px;
      }
      @supports not (height: 100dvh) {
        .scene { height: 62vh; }
      }

      .scene img { height: 52%; }
      .scene .content { height: 48%; }

      .mobileDetails { display:block; }

      /* steps still exist below (optional to keep) */
      .step { min-height: 70vh; }
    }
  </style>
</head>

<body>
  <header class="timeline-sticky">
    <div class="topline">
      <div class="title">ঢাকা: সংবাদপত্র অফিসে হামলা — স্ক্রল টাইমলাইন</div>
    </div>

    <div class="timeline-wrap">
      <div class="track"></div>
      <div class="progress" id="progress"></div>
      <div class="playhead" id="playhead"></div>
      <div class="ticks" id="ticks"></div>
      <div class="activeTimeCenter" id="activeTime">সময়: —</div>
    </div>

    <div class="labels">
      <span>১৮ ডিসেম্বর ১০:০০ PM</span>
      <span>১৯ ডিসেম্বর ০৬:০০ PM</span>
    </div>
  </header>

  <main class="container">
    <section id="steps"></section>

    <aside class="scene" aria-live="polite">
      <img id="sceneImg" alt="" decoding="async">
      <div class="content">
        <!-- Always show shortText -->
        <div class="body" id="sceneBody"></div>

        <!-- Mobile-only: show timeLabel + title + longText too -->
        <div class="mobileDetails" id="mobileDetails">
          <div class="mWhen" id="mWhen"></div>
          <h3 class="mTitle" id="mTitle"></h3>
          <div class="mLong" id="mLong"></div>
        </div>
      </div>
    </aside>
  </main>

  <script src="https://unpkg.com/scrollama"></script>
  <script>
    const SCENES = [
      { id:"s1",  progress:0/11,  timeLabel:"১৮ ডিসেম্বর ১০:০২ PM", titleBn:"প্রথম আহ্বান দেখা যায়",
        longText:"ডামি লং টেক্সট: এই পর্যায়ে বিভিন্ন পোস্টে উসকানিমূলক ভাষা ধরা পড়তে শুরু করে... (আরও বিস্তারিত এখানে থাকবে)।",
        shortText:"সংক্ষিপ্ত: উসকানিমূলক ভাষা প্রথম চোখে পড়ে।",
        image:"assets/scene1.jpg"
      },
      { id:"s2",  progress:1/11,  timeLabel:"১৮ ডিসেম্বর ১০:২০ PM", titleBn:"বার্তা ছড়াতে শুরু",
        longText:"ডামি লং টেক্সট: একাধিক গ্রুপ ও পেজে একই বক্তব্য কপি-পেস্ট হয়ে ছড়াতে থাকে...",
        shortText:"সংক্ষিপ্ত: কপি-পেস্ট করে দ্রুত শেয়ার বাড়ে।",
        image:"assets/scene2.jpg"
      },
      { id:"s3",  progress:2/11,  timeLabel:"১৮ ডিসেম্বর ১০:৪০ PM", titleBn:"বৈধতা দেওয়ার ভাষা",
        longText:"ডামি লং টেক্সট: ‘প্রাপ্য ছিল’, ‘ঠিক হয়েছে’— এমন যুক্তি দিয়ে ঘটনাকে বৈধতা দেওয়ার প্রবণতা জোরালো হয়...",
        shortText:"সংক্ষিপ্ত: ‘প্রাপ্য’ বলে বৈধতা দেওয়া শুরু।",
        image:"assets/scene3.jpg"
      },
      { id:"s4",  progress:3/11,  timeLabel:"১৮ ডিসেম্বর ১১:০৫ PM", titleBn:"লক্ষ্য নির্ধারণ/ট্যাগিং",
        longText:"ডামি লং টেক্সট: নির্দিষ্ট ব্যক্তি/প্রতিষ্ঠানের নাম উল্লেখ করে পোস্ট বাড়ে...",
        shortText:"সংক্ষিপ্ত: নাম-উল্লেখ ও ট্যাগিং বাড়ে।",
        image:"assets/scene4.jpg"
      },
      { id:"s5",  progress:4/11,  timeLabel:"১৮ ডিসেম্বর ১১:৩০ PM", titleBn:"কলে টু অ্যাকশন",
        longText:"ডামি লং টেক্সট: ‘চল’, ‘এখনই’, ‘যেতে হবে’— এমন ভাষা দেখা যায়...",
        shortText:"সংক্ষিপ্ত: সরাসরি কর্মসূচির ইঙ্গিত বাড়ে।",
        image:"assets/scene5.jpg"
      },
      { id:"s6",  progress:5/11,  timeLabel:"১৮ ডিসেম্বর ১১:৪৫ PM", titleBn:"ছবি/ভিডিও ছড়ায়",
        longText:"ডামি লং টেক্সট: ভিডিও/ছবি শেয়ার বাড়তে থাকে...",
        shortText:"সংক্ষিপ্ত: ভিজ্যুয়াল কনটেন্ট শেয়ার বেড়ে যায়।",
        image:"assets/scene6.jpg"
      },
      { id:"s7",  progress:6/11,  timeLabel:"১৯ ডিসেম্বর ১২:৩০ AM", titleBn:"গুজব/দাবি যোগ",
        longText:"ডামি লং টেক্সট: যাচাইহীন দাবি, অতিরঞ্জিত সংখ্যা/ঘটনা যুক্ত হতে থাকে...",
        shortText:"সংক্ষিপ্ত: যাচাইহীন দাবি যোগ হতে থাকে।",
        image:"assets/scene7.jpg"
      },
      { id:"s8",  progress:7/11,  timeLabel:"১৯ ডিসেম্বর ০২:১৫ AM", titleBn:"মিম/ব্যঙ্গ",
        longText:"ডামি লং টেক্সট: মিম, ব্যঙ্গচিত্র এবং ক্যাপশন-ভিত্তিক কনটেন্ট দ্রুত ছড়ায়...",
        shortText:"সংক্ষিপ্ত: মিম কনটেন্ট ভাইরাল হতে থাকে।",
        image:"assets/scene8.jpg"
      },
      { id:"s9",  progress:8/11,  timeLabel:"১৯ ডিসেম্বর ০৭:৩০ AM", titleBn:"প্রতিরোধী কণ্ঠ",
        longText:"ডামি লং টেক্সট: কিছু পোস্ট হামলার বিরোধিতা করে শান্ত থাকার আহ্বান জানায়...",
        shortText:"সংক্ষিপ্ত: বিরোধিতা/শান্তির আহ্বান দেখা যায়।",
        image:"assets/scene9.jpg"
      },
      { id:"s10", progress:9/11,  timeLabel:"১৯ ডিসেম্বর ০৯:৩০ AM", titleBn:"উদযাপন ও পুনঃশেয়ার",
        longText:"ডামি লং টেক্সট: কিছু পোস্ট উদযাপনধর্মী ভাষা ব্যবহার করে, রি-শেয়ার বাড়ে...",
        shortText:"সংক্ষিপ্ত: উদযাপন ও রি-শেয়ার বাড়ে।",
        image:"assets/scene10.jpg"
      },
      { id:"s11", progress:10/11, timeLabel:"১৯ ডিসেম্বর ০১:৪৫ PM", titleBn:"বিতর্ক/পাল্টাপাল্টি",
        longText:"ডামি লং টেক্সট: কমেন্টে তর্ক, পাল্টা অভিযোগ এবং স্ক্রিনশট-যুদ্ধ দেখা যায়...",
        shortText:"সংক্ষিপ্ত: পাল্টাপাল্টি বিতর্ক তীব্র হয়।",
        image:"assets/scene11.jpg"
      },
      { id:"s12", progress:11/11, timeLabel:"১৯ ডিসেম্বর ০৬:০০ PM", titleBn:"শেষ পর্যায়",
        longText:"ডামি লং টেক্সট: সমর্থন/বিরোধিতা/উদযাপন— সবধরনের প্রতিক্রিয়া স্থিতিশীল হয়...",
        shortText:"সংক্ষিপ্ত: প্রতিক্রিয়ার ধারা স্থিতিশীল হয়।",
        image:"assets/scene12.jpg"
      }
    ];

    // ticks
    const ticksRoot = document.getElementById("ticks");
    const tickEls = [];
    SCENES.forEach((s) => {
      const t = document.createElement("div");
      t.className = "tick";
      t.style.left = (Math.max(0, Math.min(1, s.progress)) * 100) + "%";
      ticksRoot.appendChild(t);
      tickEls.push(t);
    });

    // steps
    const stepsRoot = document.getElementById("steps");
    SCENES.forEach((s, idx) => {
      const el = document.createElement("div");
      el.className = "step";
      el.dataset.index = idx;
      el.innerHTML = `
        <div class="when">${s.timeLabel}</div>
        <h3>${s.titleBn}</h3>
        <p>${escapeHtml(s.longText)}</p>
      `;
      stepsRoot.appendChild(el);
    });

    const playhead = document.getElementById("playhead");
    const progress = document.getElementById("progress");
    const activeTime = document.getElementById("activeTime");

    // mobile details targets
    const mWhen = document.getElementById("mWhen");
    const mTitle = document.getElementById("mTitle");
    const mLong = document.getElementById("mLong");

    function renderScene(idx) {
      const s = SCENES[idx];
      const pct = Math.max(0, Math.min(1, s.progress)) * 100;

      playhead.style.left = pct + "%";
      progress.style.width = pct + "%";

      tickEls.forEach(x => x.classList.remove("is-active"));
      tickEls[idx]?.classList.add("is-active");

      document.getElementById("sceneImg").src = s.image || "";
      document.getElementById("sceneBody").textContent = s.shortText || "";

      // mobile: show time/title/long inside scene too
      mWhen.textContent = s.timeLabel || "";
      mTitle.textContent = s.titleBn || "";
      mLong.textContent = s.longText || "";

      activeTime.textContent = "সময়: " + (s.timeLabel || "—");
    }

    const scroller = scrollama();
    scroller.setup({ step: ".step", offset: 0.6 })
      .onStepEnter(({ element }) => {
        document.querySelectorAll(".step").forEach(x => x.classList.remove("is-active"));
        element.classList.add("is-active");
        renderScene(Number(element.dataset.index));
      });

    function onResize(){ scroller.resize(); }
    window.addEventListener("resize", onResize);
    window.addEventListener("orientationchange", onResize);

    renderScene(0);
    document.querySelector(".step")?.classList.add("is-active");

    function escapeHtml(str) {
      return String(str ?? "").replace(/[&<>"']/g, s => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[s]));
    }
  </script>
</body>
</html>
